<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Court Craft Journal</title>
    
    <!-- Modular CSS Files -->
    <link rel="stylesheet" href="base.css">
    <link rel="stylesheet" href="auth.css">
    <link rel="stylesheet" href="layout.css">
    <link rel="stylesheet" href="forms.css">
    <link rel="stylesheet" href="history.css">
    <link rel="stylesheet" href="insights.css">
    <link rel="stylesheet" href="toast.css">
   
</head>
<body>
    <!-- Authentication Screen -->
    <div id="authScreen" class="auth-screen">
        <div class="auth-container">
            <div class="auth-header">
                <h1>üéæ Court Craft Journal</h1>
                <p>Track your squash performance and improve your game</p>
            </div>
            
            <!-- Login Form -->
            <div id="loginForm" class="auth-form">
                <h2>Welcome Back</h2>
                <form onsubmit="handleLogin(event)">
                    <div class="form-group">
                        <label for="loginEmail">Email</label>
                        <input type="email" id="loginEmail" required placeholder="your@email.com">
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Password</label>
                        <input type="password" id="loginPassword" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                    </div>
                    <div id="loginError" class="error-message"></div>
                    <button type="submit" class="auth-btn">Log In</button>
                </form>
                <p class="auth-toggle">
                    Don't have an account? 
                    <a href="#" onclick="toggleAuthMode(); return false;">Sign up</a>
                </p>
            </div>
            
            <!-- Signup Form -->
            <div id="signupForm" class="auth-form" style="display: none;">
                <h2>Create Account</h2>
                <form onsubmit="handleSignup(event)">
                    <div class="form-group">
                        <label for="signupEmail">Email</label>
                        <input type="email" id="signupEmail" required placeholder="your@email.com">
                    </div>
                    <div class="form-group">
                        <label for="signupPassword">Password</label>
                        <input type="password" id="signupPassword" required placeholder="At least 6 characters">
                    </div>
                    <div class="form-group">
                        <label for="signupConfirmPassword">Confirm Password</label>
                        <input type="password" id="signupConfirmPassword" required placeholder="Re-enter password">
                    </div>
                    <div id="signupError" class="error-message"></div>
                    <button type="submit" class="auth-btn">Sign Up</button>
                </form>
                <p class="auth-toggle">
                    Already have an account? 
                    <a href="#" onclick="toggleAuthMode(); return false;">Log in</a>
                </p>
            </div>
        </div>
    </div>

    <!-- Main Application (hidden until logged in) -->
    <div id="mainApp" style="display: none;">
        <div class="container">
            <div class="header">
                <h1>üèãÔ∏è Daily Sports Performance Journal</h1>
                <p>Track your performance and discover what makes you succeed</p>
                <div class="user-info">
                    <span id="userEmail"></span>
                    <button onclick="handleLogout()" class="logout-btn">Logout</button>
                </div>
            </div>

            <div class="tabs">
                <div class="tab active" onclick="switchTab('journal')">üìù New Entry</div>
                <div class="tab" onclick="switchTab('history')">üìö History</div>
                <div class="tab" onclick="switchTab('insights')">üìä Insights</div>
            </div>

            <div class="content">
                <div id="journal" class="view active">
                    <div class="quick-actions">
                        <button class="quick-btn" onclick="clearForm()">üóëÔ∏è Clear Form</button>
                    </div>
                    
                    <div class="journal-section">
                        <h2>üìÖ Date and Session Type</h2>
                        <label for="entryDate">Date of Session:</label>
                        <input type="date" id="entryDate" required>
                        <input type="hidden" id="editingKey">

                        <label for="sessionTypeSelect">Overall Session Type:</label>
                        <select id="sessionTypeSelect" onchange="updateSessionType()">
                            <option value="">Select Type</option>
                            <option value="Match Day">Match Play</option>
                            <option value="Training">Training Session</option>
                            <option value="Recovery">Recovery Session</option>
                        </select>
                    </div>
                    
                    <div class="journal-section">
                        <h2>‚òÄÔ∏è Weather & Environment</h2>
                        <label for="weatherCondition">Condition:</label>
                        <select id="weatherCondition">
                            <option value="sunny">‚òÄÔ∏è Sunny</option>
                            <option value="cloudy">‚òÅÔ∏è Cloudy</option>
                            <option value="rainy">üåßÔ∏è Rainy</option>
                            <option value="snowy">‚ùÑÔ∏è Snowy</option>
                            <option value="indoor">üè¢ Indoor (Controlled)</option>
                        </select>
                        
                        <label for="temperature">Temperature (¬∞C):</label>
                        <input type="number" id="temperature" placeholder="e.g., 22">
                        
                        <label for="surface">Playing Surface/Area:</label>
                        <input type="text" id="surface" placeholder="e.g., Turf, Track, Weight Room">
                    </div>
                    
                    <div class="journal-section" id="nutritionSection">
                        <h2>üéØ Nutrition & Recovery</h2>
                        <label for="preWorkoutMeal">Pre-Workout Meal/Snack:</label>
                        <textarea id="preWorkoutMeal" placeholder="What did you eat and when?"></textarea>
                        
                        <label for="hydration">Hydration (Liters):</label>
                        <input type="number" id="hydration" step="0.1" placeholder="e.g., 2.5">

                        <label for="sleepHours">Sleep Hours Last Night:</label>
                        <input type="number" id="sleepHours" step="0.5" placeholder="e.g., 7.5">
                    </div>
                    
                    <div class="journal-section" id="exerciseSection">
                        <h2>üèÉ Exercise & Performance</h2>
                        
                        <input type="hidden" id="sessionType" onchange="toggleMatchFields()">

                        <label for="sessionDetails">Details & Metrics:</label>
                        <textarea id="sessionDetails" placeholder="Specific exercises, sets, reps, distance, time, and heart rate data."></textarea>
                        
                        <label for="sessionRating">Overall Session Rating (1-Poor to 5-Excellent):</label>
                        <input type="number" id="sessionRating" min="1" max="5" placeholder="e.g., 4" required>

                        <label for="notes">Notes on Feeling & Reflection:</label>
                        <textarea id="notes" placeholder="How did you feel mentally and physically? What went well or poorly?"></textarea>

                        <div id="matchFields" style="display: none;">
                            <h3>üéæ Match Details</h3>
                            
                            <label for="opponentName">Opponent Name:</label>
                            <input type="text" id="opponentName" placeholder="Full Name">
                            
                            <div class="level-group">
                                <div class="level-item">
                                    <label for="opponentLevel">Opponent Level:</label>
                                    <input type="text" id="opponentLevel" placeholder="Squash Levels">
                                </div>
                                <div class="level-item">
                                    <label for="yourLevel">Your Level:</label>
                                    <input type="text" id="yourLevel" placeholder="Squash Levels">
                                </div>
                            </div>
                            <label for="gameScores">Game Scores:</label>
                            <textarea id="gameScores" placeholder="11-4, 11-6, 11-6"></textarea>

<h3>üéæ My Performance Analysis</h3>
<p style="color: var(--gray-600); margin-bottom: 1.5rem; font-size: 0.9rem;">Rate each aspect from 1 (poor) to 10 (excellent) and add notes</p>

<!-- Length and Width -->
<label for="perfLengthWidthRating">Length and Width - Rating:</label>
<select id="perfLengthWidthRating">
    <option value="">Select Rating (1-10)</option>
    <option value="10">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 10 - Excellent</option>
    <option value="9">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 9 - Outstanding</option>
    <option value="8">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 8 - Very Good</option>
    <option value="7">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 7 - Good</option>
    <option value="6">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 6 - Above Average</option>
    <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 5 - Average</option>
    <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê 4 - Below Average</option>
    <option value="3">‚≠ê‚≠ê‚≠ê 3 - Poor</option>
    <option value="2">‚≠ê‚≠ê 2 - Very Poor</option>
    <option value="1">‚≠ê 1 - Terrible</option>
</select>

<label for="perfLengthWidth">Length and Width - Notes:</label>
<textarea id="perfLengthWidth" placeholder="Describe your target hitting, depth control, and court coverage..."></textarea>

<!-- Height and Pace -->
<label for="perfHeightPaceRating">Height and Pace - Rating:</label>
<select id="perfHeightPaceRating">
    <option value="">Select Rating (1-10)</option>
    <option value="10">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 10 - Excellent</option>
    <option value="9">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 9 - Outstanding</option>
    <option value="8">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 8 - Very Good</option>
    <option value="7">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 7 - Good</option>
    <option value="6">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 6 - Above Average</option>
    <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 5 - Average</option>
    <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê 4 - Below Average</option>
    <option value="3">‚≠ê‚≠ê‚≠ê 3 - Poor</option>
    <option value="2">‚≠ê‚≠ê 2 - Very Poor</option>
    <option value="1">‚≠ê 1 - Terrible</option>
</select>

<label for="perfHeightPace">Height and Pace - Notes:</label>
<textarea id="perfHeightPace" placeholder="Describe how you controlled the pace and used height..."></textarea>

<!-- Control and T Position -->
<label for="perfControlTRating">Control and T Position - Rating:</label>
<select id="perfControlTRating">
    <option value="">Select Rating (1-10)</option>
    <option value="10">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 10 - Excellent</option>
    <option value="9">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 9 - Outstanding</option>
    <option value="8">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 8 - Very Good</option>
    <option value="7">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 7 - Good</option>
    <option value="6">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 6 - Above Average</option>
    <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 5 - Average</option>
    <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê 4 - Below Average</option>
    <option value="3">‚≠ê‚≠ê‚≠ê 3 - Poor</option>
    <option value="2">‚≠ê‚≠ê 2 - Very Poor</option>
    <option value="1">‚≠ê 1 - Terrible</option>
</select>

<label for="perfControlT">Control and T Position - Notes:</label>
<textarea id="perfControlT" placeholder="Describe your court control and T position dominance..."></textarea>

<!-- Movement -->
<label for="perfMovementRating">Movement - Rating:</label>
<select id="perfMovementRating">
    <option value="">Select Rating (1-10)</option>
    <option value="10">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 10 - Excellent</option>
    <option value="9">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 9 - Outstanding</option>
    <option value="8">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 8 - Very Good</option>
    <option value="7">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 7 - Good</option>
    <option value="6">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 6 - Above Average</option>
    <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 5 - Average</option>
    <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê 4 - Below Average</option>
    <option value="3">‚≠ê‚≠ê‚≠ê 3 - Poor</option>
    <option value="2">‚≠ê‚≠ê 2 - Very Poor</option>
    <option value="1">‚≠ê 1 - Terrible</option>
</select>

<label for="perfMovement">Movement - Notes:</label>
<textarea id="perfMovement" placeholder="Describe your efficiency, explosiveness, and balance..."></textarea>

<!-- Attack -->
<label for="perfAttackRating">Attack - Rating:</label>
<select id="perfAttackRating">
    <option value="">Select Rating (1-10)</option>
    <option value="10">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 10 - Excellent</option>
    <option value="9">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 9 - Outstanding</option>
    <option value="8">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 8 - Very Good</option>
    <option value="7">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 7 - Good</option>
    <option value="6">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 6 - Above Average</option>
    <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 5 - Average</option>
    <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê 4 - Below Average</option>
    <option value="3">‚≠ê‚≠ê‚≠ê 3 - Poor</option>
    <option value="2">‚≠ê‚≠ê 2 - Very Poor</option>
    <option value="1">‚≠ê 1 - Terrible</option>
</select>

<label for="perfAttack">Attack - Notes:</label>
<textarea id="perfAttack" placeholder="Describe how you attacked during your match..."></textarea>

<!-- Hitting to Space -->
<label for="perfHittingToSpaceRating">Hitting to Space - Rating:</label>
<select id="perfHittingToSpaceRating">
    <option value="">Select Rating (1-10)</option>
    <option value="10">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 10 - Excellent</option>
    <option value="9">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 9 - Outstanding</option>
    <option value="8">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 8 - Very Good</option>
    <option value="7">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 7 - Good</option>
    <option value="6">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 6 - Above Average</option>
    <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 5 - Average</option>
    <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê 4 - Below Average</option>
    <option value="3">‚≠ê‚≠ê‚≠ê 3 - Poor</option>
    <option value="2">‚≠ê‚≠ê 2 - Very Poor</option>
    <option value="1">‚≠ê 1 - Terrible</option>
</select>

<label for="perfHittingToSpace">Hitting to Space - Notes:</label>
<textarea id="perfHittingToSpace" placeholder="Describe your spatial awareness and shot placement..."></textarea>

                            <h3>Opponent Analysis</h3>
                            <label for="oppStrengths">Opponent's Strengths:</label>
                            <textarea id="oppStrengths" placeholder="Describe strengths of your opponents"></textarea>

                            <label for="oppWeaknesses">Opponent's Weaknesses:</label>
                            <textarea id="oppWeaknesses" placeholder="Describe weaknesses of your opponent"></textarea>

                            <label for="matchSummary">Summary and Comments:</label>
                            <textarea id="matchSummary" placeholder="Overall reflection on the match"></textarea>
                            
                            <label for="oneThingToWorkOn">One Thing to Work On:</label>
                            <textarea id="oneThingToWorkOn" placeholder="The single most important technical or tactical element to practice next."></textarea>
                        </div>   
                    </div>

                    <button onclick="saveEntry()" id="saveBtn">üíæ Save Journal Entry</button>
                    <button onclick="cancelEdit()" id="cancelBtn" class="btn-secondary" style="display: none;">‚ùå Cancel Edit</button>
                </div>

                <div id="history" class="view">
                    <div class="export-section">
                        <button onclick="showImportDialog()">üì• Import Diary Entries</button>
                        <button onclick="exportToCSV()">üìä Export to CSV</button>
                    </div>
                    
                                    
                    <div class="filter-section">
                        <h2>üîç Search & Filter</h2>
                        
                        <div class="search-box">
    <label for="searchKeyword">Search:</label>
    <input type="text" id="searchKeyword" placeholder="Search exercises, meals, notes..." oninput="debouncedSearch()">
</div>
                        
                        <div class="filter-row">
                            <div class="filter-group">
                                <label for="filterRating">Rating:</label>
                                <select id="filterRating" onchange="loadHistory()">
                                    <option value="">All Ratings</option>
                                    <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Excellent (5)</option>
                                    <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê Good (4)</option>
                                    <option value="3">‚≠ê‚≠ê‚≠ê Average (3)</option>
                                    <option value="2">‚≠ê‚≠ê Poor (2)</option>
                                    <option value="1">‚≠ê Very Poor (1)</option>
                                </select>
                            </div>
                                                                             
                            <div class="filter-group">
                                <label for="dateRange">Date Range:</label>
                                <select id="dateRange" onchange="loadHistory()">
                                    <option value="all">All Time</option>
                                    <option value="7">Last 7 Days</option>
                                    <option value="30">Last 30 Days</option>
                                    <option value="90">Last 90 Days</option>
                                    <option value="month">This Month</option>
                                    <option value="year">This Year</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="sort-controls">
                            <label for="sortBy">Sort by:</label>
                            <select id="sortBy" onchange="loadHistory()">
                                <option value="date-desc">Date (Newest First)</option>
                                <option value="date-asc">Date (Oldest First)</option>
                                <option value="rating-desc">Rating (Highest First)</option>
                                <option value="rating-asc">Rating (Lowest First)</option>
                                <option value="sleep-desc">Sleep (Most First)</option>
                                <option value="sleep-asc">Sleep (Least First)</option>
                            </select>
                        </div>
                    </div>
                    <div id="entriesContainer"></div>
                </div>

                <div id="insights" class="view">
                    <div class="stats-grid" id="statsGrid"></div>
                    <div id="insightsContainer"></div>
                </div>
            </div>
        </div>
    </div>

  
    <!-- Load all JavaScript modules -->
    <script type="module" src="firebase-config.js"></script>
    <script type="module" src="auth.js"></script>
    <script type="module" src="firestore-service.js"></script>
    <script type="module" src="ui-helpers.js"></script>
    <script type="module" src="form-handlers.js"></script>
    <script type="module" src="history.js"></script>
    <script type="module" src="insights.js"></script>
    <script type="module" src="export.js"></script>
    <script type="module" src="app.js"></script>
</body>
</html>